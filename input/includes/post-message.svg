<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="966" height="648"><desc>entryspacing%200.5%0Aparticipantgroup%20%23lightblue%20%2B%2B**EHR%20Browser%20Interface**%5Cnhttps%3A%2F%2Fehr.example.org%2B%2B%0A%0Aparticipantspacing%205%0Aparticipant%20%22%2B%2Behr.window%2B%2B%22%20as%20ehr.window%0Alifelinestyle%20ehr.window%20%3A%3Asolid%0A%0Aparticipantgroup%20%23lightgreen%20%2B%2B**embedded%20iframe**%2B%2B%0A%20participant%20%22%2B%2Bapp.window%2B%2B%22%20as%20app.window%0A%20end%0A%20lifelinestyle%20app.window%20%3A%3Asolid%0Aend%0A%0Aparticipantgroup%20%23pink%20%2B%2B**EHR%20Auth%20Server**%2B%2B%0Aparticipant%20%22%2B%2Bauthorize.html%2B%2B%22%20as%20authorize.html%0Alifelinestyle%20%3A%3Asolid%0Aend%0A%0A%0Aparallel%0Agroup%20%23orange%20SMART%20Launch%0Aauthorize.html%3C-%3Eapp.window%3A%20%0Aparallel%20off%0A%0A%0Afontfamily%20monospace%0Abox%20over%20app.window%20%23lightyellow%3A%20%2B%2BlaunchClientData%20%3D%20%7B%5Cn%20%20%22smart_web_messaging_handle%22%3A%20**%22RXhhbXBsZSBoYW5kbGUK%22**%2C%5Cn%20%20%22smart_web_messaging_origin%22%3A%20**%22https%3A%2F%2Fehr.example.org%22**%2C%5Cn...%5Cn%7D%2B%2B%0Aend%0A%0Aspace%201%0Aehr.window%3C-app.window%3A%20%2B%2BpostMessage(message%2C%20**%22https%3A%2F%2Fehr.example.org%22**)%2B%2B%20%20%20%20%0Abox%20over%20app.window%20%23lightyellow%3A%20%2B%2Bmessage%20%3D%20%7B%5Cn%20%20%22messageId%22%3A%20**%22248cd0b0-5167-4824-babc-f250e5296527%22**%2C%5Cn%20%20%22messagingHandle%22%3A%20**%22RXhhbXBsZSBoYW5kbGUK%22**%2C%5Cn%20%20%22messageType%22%3A%20%22ui.launchActivity%22%2C%5Cn%20%20%22payload%22%3A%20%7B...%7D%5Cn%7D%2B%2B%0A%0Aspace%201%0Aapp.window%3C-ehr.window%3A%20%2B%2BpostMessage(response%2C%20%22https%3A%2F%2Fapp%2Fafter-auth%22)%2B%2B%0Afontfamily%20monospace%0Abox%20over%20ehr.window%20%23lightyellow%3A%20%2B%2Bresponse%20%3D%20%7B%5Cn%20%20%22messageID%22%3A%20%229befe172-f5b2-408b-a993-939690f5388b%22%2C%5Cn%20%20%22responseToMessageId%22%3A%20**%22248cd0b0-5167-4824-babc-f250e5296527%22**%2C%5Cn%20%20%22payload%22%3A%20%7B...%7D%5Cn%7D%2B%2B%0Afontfamily%20arial</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="966" height="648"/></g><g><g><path fill="lightblue" stroke="black" paint-order="fill stroke markers" d=" M 190.2221269887383 5.880673187999996 L 695.3097686314168 5.880673187999996 L 695.3097686314168 643.757796512 L 190.2221269887383 643.757796512 L 190.2221269887383 5.880673187999996" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="382.0793251904486" y="21.763517011999994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">EHR Browser Interface</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="382.0793251904486" y="33.826436371999996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="409.472239008808" y="33.826436371999996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="415.6956581982611" y="33.826436371999996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">ehr.example.org</text></g><g><path fill="lightgreen" stroke="black" paint-order="fill stroke markers" d=" M 599.2674226528777 43.677820516 L 690.2835522314167 43.677820516 L 690.2835522314167 643.757796512 L 599.2674226528777 643.757796512 L 599.2674226528777 43.677820516" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="598.4060187531824" y="59.56066434" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">embedded iframe</text></g><g><path fill="pink" stroke="black" paint-order="fill stroke markers" d=" M 858.7865630092175 43.677820516 L 960.9971963719362 43.677820516 L 960.9971963719362 643.757796512 L 858.7865630092175 643.757796512 L 858.7865630092175 43.677820516" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="864.7692905792487" y="59.56066434" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">EHR Auth Server</text></g><rect fill="rgb(255,237,204)" stroke="none" x="430.7644118750769" y="112.48672303200001" width="514.3109826154999" height="153.70169751199998"/></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 234.17432935125 99.921182032 L 234.17432935125 643.757796512" stroke-miterlimit="10" stroke-width="0.8377027333333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 644.7754874421472 99.921182032 L 644.7754874421472 643.757796512" stroke-miterlimit="10" stroke-width="0.8377027333333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 909.8918796905768 99.921182032 L 909.8918796905768 643.757796512" stroke-miterlimit="10" stroke-width="0.8377027333333333"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 195.2483433887383 70.266505272 L 273.1003153137617 70.266505272 L 273.1003153137617 99.921182032 L 195.2483433887383 99.921182032 L 195.2483433887383 70.266505272 Z" stroke-miterlimit="10" stroke-width="1.608389248" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="206.1552329767383" y="89.26560326399999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">ehr.window</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 604.2936390528777 70.266505272 L 685.2573358314168 70.266505272 L 685.2573358314168 99.921182032 L 604.2936390528777 99.921182032 L 604.2936390528777 70.266505272 Z" stroke-miterlimit="10" stroke-width="1.608389248" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="615.2005286408777" y="89.26560326399999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">app.window</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 863.8127794092175 70.266505272 L 955.9709799719362 70.266505272 L 955.9709799719362 99.921182032 L 863.8127794092175 99.921182032 L 863.8127794092175 70.266505272 Z" stroke-miterlimit="10" stroke-width="1.608389248" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="874.7196689972175" y="89.26560326399999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">authorize.html</text></g></g><g><g><g><rect fill="rgb(255,237,204)" stroke="none" x="774.883403071362" y="132.08896699200002" width="4.90056099" height="13.06816264"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="777.333683566362" y="141.136156512" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 901.6153766852435 145.15712963200002 L 653.0519904474805 145.15712963200002" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray=""/><g transform="translate(644.7754874421472,145.15712963200002) translate(-644.7754874421472,-145.15712963200002)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 653.1525147754805 140.96861596533336 L 644.7754874421472 145.15712963200002 L 653.1525147754805 149.3456432986667 Z"/><g transform="translate(909.8918796905768,145.15712963200002) translate(-909.8918796905768,-145.15712963200002)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 901.5148523572435 140.96861596533336 L 909.8918796905768 145.15712963200002 L 901.5148523572435 149.3456432986667 Z"/></g></g></g><path fill="lightyellow" stroke="black" paint-order="fill stroke markers" d=" M 435.7906282750769 152.696454232 L 853.7603466092175 152.696454232 L 853.7603466092175 258.649095944 L 435.7906282750769 258.649095944 L 435.7906282750769 152.696454232" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="449.8640341950769" y="174.00761176800003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">launchClientData = {</text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="449.8640341950769" y="192.10199080800004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  "smart_web_messaging_handle": </text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="664.9387412263269" y="192.10199080800004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">"RXhhbXBsZSBoYW5kbGUK"</text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="812.8026023103113" y="192.10199080800004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">,</text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="449.8640341950769" y="210.19636984800005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  "smart_web_messaging_origin": </text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="664.9387412263269" y="210.19636984800005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">"https:</text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="711.9863333894128" y="210.19636984800005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="725.428502578866" y="210.19636984800005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">ehr.example.org"</text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="832.965856094491" y="210.19636984800005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">,</text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="449.8640341950769" y="228.29074888800005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">...</text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="449.8640341950769" y="246.38512792800006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">}</text></g><g><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="270.3316054792182" y="307.60444368" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">postMessage(message, </text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="411.474381968476" y="307.60444368" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">"https:</text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="458.52197413156193" y="307.60444368" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="471.96414332101506" y="307.60444368" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">ehr.example.org"</text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="579.5014968366401" y="307.60444368" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">)</text><text fill="black" stroke="none" font-family="monospace" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="586.2225814313666" y="307.60444368" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    </text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 644.7754874421472 314.842195296 L 242.45083235658333 314.842195296" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray=""/><g transform="translate(234.17432935125,314.842195296) translate(-234.17432935125,-314.842195296)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 242.55135668458334 310.65368162933333 L 234.17432935125 314.842195296 L 242.55135668458334 319.03070896266667 Z"/></g></g><path fill="lightyellow" stroke="black" paint-order="fill stroke markers" d=" M 449.23279746453005 322.381519896 L 840.3181774197644 322.381519896 L 840.3181774197644 446.428540648 L 449.23279746453005 446.428540648 L 449.23279746453005 322.381519896" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="463.30620338453" y="343.69267743200004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">message = {</text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="463.30620338453" y="361.787056472" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  "messageId": </text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="564.1224723054285" y="361.787056472" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">"248cd0b0-5167-4824-babc-f250e5296527"</text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="819.5236869050378" y="361.787056472" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">,</text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="463.30620338453" y="379.881435512" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  "messagingHandle": </text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="604.4489798737878" y="379.881435512" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">"RXhhbXBsZSBoYW5kbGUK"</text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="752.3128409577722" y="379.881435512" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">,</text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="463.30620338453" y="397.975814552" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  "messageType": "ui.launchActivity",</text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="463.30620338453" y="416.07019359199995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  "payload": {...}</text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="463.30620338453" y="434.16457263199993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">}</text></g><g><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="281.52942042062443" y="487.844563784" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">postMessage(response, "https:</text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="476.44087366769475" y="487.844563784" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="489.88304285714787" y="487.844563784" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">app/after-auth")</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 234.17432935125 495.0823154 L 636.4989844368139 495.0823154" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray=""/><g transform="translate(644.7754874421472,495.0823154) translate(-644.7754874421472,-495.0823154)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 636.3984601088139 490.89380173333336 L 644.7754874421472 495.0823154 L 636.3984601088139 499.2708290666667 Z"/></g></g><path fill="lightyellow" stroke="black" paint-order="fill stroke markers" d=" M 5.0262164 502.62164 L 463.3224423025 502.62164 L 463.3224423025 608.574281712 L 5.0262164 608.574281712 L 5.0262164 502.62164" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="19.09962232000001" y="523.932797536" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">response = {</text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="19.09962232000001" y="542.027176576" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  "messageID": "9befe172-f5b2-408b-a993-939690f5388b",</text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="19.09962232000001" y="560.121555616" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  "responseToMessageId": </text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="bold" text-decoration="normal" x="187.12673718816407" y="560.121555616" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">"248cd0b0-5167-4824-babc-f250e5296527"</text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="442.5279517877734" y="560.121555616" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">,</text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="19.09962232000001" y="578.2159346560001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  "payload": {...}</text><text fill="black" stroke="none" font-family="monospace" font-size="8.4pt" font-style="normal" font-weight="normal" text-decoration="normal" x="19.09962232000001" y="596.3103136960001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">}</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 430.7644118750769 112.48672303200001 L 945.0753944905769 112.48672303200001 L 945.0753944905769 266.188420544 L 430.7644118750769 266.188420544 L 430.7644118750769 112.48672303200001 Z" stroke-miterlimit="10" stroke-width="1.4360618285714286" stroke-dasharray=""/><path fill="orange" stroke="black" paint-order="fill stroke markers" d=" M 430.7644118750769 112.48672303200001 L 430.7644118750769 124.54964239200001 L 505.9886622407019 124.54964239200001 L 512.0201219207019 118.51818271200001 L 512.0201219207019 112.48672303200001 L 430.7644118750769 112.48672303200001" stroke-miterlimit="10" stroke-width="1.4360618285714286" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="5.6000000000000005pt" font-style="normal" font-weight="bold" text-decoration="normal" x="440.81684467507694" y="120.52866927200002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">SMART Launch</text></g></g></g></svg>
<!--

SVG Source: https://sequencediagram.org/
Resize SVG to less than or equal to 1100 px wide and export.
========================================

entryspacing 0.5
participantgroup #lightblue ++**EHR Browser Interface**\nhttps://ehr.example.org++

participantspacing 5
participant "++ehr.window++" as ehr.window
lifelinestyle ehr.window ::solid

participantgroup #lightgreen ++**embedded iframe**++
 participant "++app.window++" as app.window
 end
 lifelinestyle app.window ::solid
end

participantgroup #pink ++**EHR Auth Server**++
participant "++authorize.html++" as authorize.html
lifelinestyle ::solid
end


parallel
group #orange SMART Launch
authorize.html<->app.window: 
parallel off


fontfamily monospace
box over app.window #lightyellow: ++launchClientData = {\n  "smart_web_messaging_handle": **"RXhhbXBsZSBoYW5kbGUK"**,\n  "smart_web_messaging_origin": **"https://ehr.example.org"**,\n...\n}++
end

space 1
ehr.window<-app.window: ++postMessage(message, **"https://ehr.example.org"**)++    
box over app.window #lightyellow: ++message = {\n  "messageId": **"248cd0b0-5167-4824-babc-f250e5296527"**,\n  "messagingHandle": **"RXhhbXBsZSBoYW5kbGUK"**,\n  "messageType": "ui.launchActivity",\n  "payload": {...}\n}++

space 1
app.window<-ehr.window: ++postMessage(response, "https://app/after-auth")++
fontfamily monospace
box over ehr.window #lightyellow: ++response = {\n  "messageID": "9befe172-f5b2-408b-a993-939690f5388b",\n  "responseToMessageId": **"248cd0b0-5167-4824-babc-f250e5296527"**,\n  "payload": {...}\n}++
fontfamily arial
-->
